from pandas import Series
import numpy as np

# 多层索引
d3 = Series(np.random.randn(10),
            index=[['a', 'a', 'a', 'b', 'b', 'b', 'c', 'c', 'd', 'd'], [1, 2, 3, 1, 2, 3, 1, 2, 2, 3]])
# a  1    0.862609
#    2    0.560697
#    3   -0.247900
# b  1   -1.029489
#    2   -1.041146
#    3   -1.434406
# c  1   -1.003535
#    2    2.484637
# d  2   -0.786305
#    3    0.166465
# dtype: float64
print(d3)
# 1   -1.029489
# 2   -1.041146
# 3   -1.434406
# dtype: float64
print(d3['b'])
# b  1   -1.029489
#    2   -1.041146
#    3   -1.434406
# c  1   -1.003535
#    2    2.484637
# dtype: float64
print(d3['b':'c'])

# 转换
#           1         2         3
# a -0.409215 -0.448865  0.104113
# b -1.613451  0.455259  0.152552
# c -0.990381  1.965578       NaN
# d       NaN  0.653046  1.889960
print(d3.unstack())
# a  1   -0.409215
#    2   -0.448865
#    3    0.104113
# b  1   -1.613451
#    2    0.455259
#    3    0.152552
# c  1   -0.990381
#    2    1.965578
# d  2    0.653046
#    3    1.889960
# dtype: float64
print(d3.unstack().stack())
